desc "Default build all files"
task default: [ "earl.jsonld", "earl.ttl", "index.html" ]

desc "Remove generated files"
task :clean do
  %x(rm earl.jsonld earl.ttl index.html)
end

file "earl.jsonld" => (Dir.glob('*.ttl') - %w(earl.ttl)) do
  puts "write earl.jsonld"
  %x(earl-report --format json -o earl.jsonld *.ttl)
end

file "earl.ttl" => %w(earl.jsonld) do
  puts "write earl.ttl"
  %x(earl-report --json --format ttl -o earl.ttl earl.jsonld)
end

file "index.html" => %w(template.haml earl.jsonld) do
  puts "write index.html"
  %x(earl-report --json --format html --template template.haml -o index.html earl.jsonld)
end
